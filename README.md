# QSL 卡片管理软件

## 1. 简介

本软件是一款专为业余无线电爱好者设计的QSL卡片交换管理工具。它集成了通联日志（QSO）管理、QSL卡片收发追踪、标签打印、NFC读写等多种实用功能，旨在简化和自动化卡片交换流程。软件基于Python和PyQt5开发，界面直观，操作便捷。

## 2. 核心功能

- **打印兼容**：现已兼容70mm x 50mm的标签输出，一张标签可以放置4条QSO

- **全面的日志管理**：支持手动添加、编辑、删除通联日志，并能从 `ADIF` 文件批量导入。

- **QSL卡片追踪**：为每一条收、发记录生成唯一的QSL ID，并能在日志列表中清晰地以“✔”和“✖”图标显示卡片状态。

- **自动化标签生成**：可根据日志信息，一键生成包含QSL信息、二维码的标准化标签。

- **灵活的输出选项**：生成的标签既可以直接发送到打印机进行打印，也可以导出为高分辨率的PNG图片，方便存档或后期处理。

- **强大的数据工具**：内置日志查重与合并、按时间重新排序、回收卡号、数据重置等多种管理工具，方便维护数据库的整洁。

## 3. 安装与启动

### 依赖库

本项目依赖以下第三方Python库：

- `PyQt5`: 用于构建图形用户界面。

- `adif-io`: 用于解析和生成ADIF格式的日志文件。

- `qrcode`: 用于生成二维码。

- `reportlab`: 用于生成PDF格式的标签文件。

- `Pillow`: 用于图像处理。

- `PyMuPDF`: 用于将PDF页面转换为PNG图片。

您可以通过以下命令一键安装所有依赖：

```
pip install PyQt5 adif-io qrcode reportlab Pillow PyMuPDF
```

### 启动程序

直接运行项目根目录下的 `main.py` 文件即可启动本软件：

```
python main.py
```

程序首次运行时，会自动在根目录下创建 `database` 和 `labels` 文件夹。

## 4. 使用指南

### 主界面

软件启动后，您会看到主仪表盘。这里包含了所有核心功能的入口，以及数据统计和近期动态的概览。

### 首次使用：设置呼号

在进行任何操作前，请先点击 **“设置”**，添加您自己的呼号并设为“主要呼号”。这是生成QSL卡片的基础。

### 日志管理

点击 **“日志管理”** 进入日志列表界面。

- **筛选与查询**：您可以通过上方的筛选框，按我方/对方呼号、QSL卡号、通联模式等条件进行实时筛选。

- **QSL状态**：“已发?”和“已收?”两列会以醒目的“✔”（绿色）和“✖”（红色）显示卡片交换状态。

- **按时间重排**：点击“按时间重排”按钮，可以根据通联的实际发生时间，重新为所有日志生成一个永久的排序ID。

- **添加/编辑**：点击下方的“新通联日志”按钮（或双击列表中的条目）可以进入编辑界面。

### 生成QSL卡片与标签

1. 在日志管理界面，勾选一条或多条需要处理的日志。

2. 点击 **“确认收卡 (RC)”** 或 **“确认发卡 (TC)”**。

3. 如果选择了多条日志，程序会询问您是为每条日志生成独立卡号（多卡模式），还是为所有日志生成一个共享的卡号（单卡模式）。

4. 接着，程序会弹出输出模式对话框，您可以选择：
   
   - **直接打印**：将生成的标签发送到您的默认打印机。
   
   - **导出为PNG图片**：在`labels`文件夹下，创建一个以QSL卡号命名的子文件夹，并将标签的两页分别保存为`QSL.png`和`Letter.png`。

### 手动查询

点击 **“手动查询”** 进入硬件交互界面。

- **手动查询**：在顶部的输入框中输入QSL卡号，然后按 **回车键**，右侧的“查询结果”区域会显示该卡号关联的所有通联日志。查询完成后，输入框会自动清空。

### 其他工具

- **导入ADIF**：从标准的ADIF文件中批量导入通联日志。程序会自动进行查重，并合并已有日志的信息。

- **检查并合并重复项**：扫描整个数据库，查找并自动合并内容高度相似的重复日志。

- **回收卡号**：当一张卡片作废时，可以通过此功能解除其与日志的关联。

- **重置数据**：在“设置”界面的“危险区域”中，可以清空所有QSL卡片相关的数据，此操作需要密码确认，请谨慎使用。
